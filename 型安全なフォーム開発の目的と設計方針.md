# プロジェクト名: SchemaSync

## 概要
Pydanticで定義したデータスキーマをSingle Source of Truthとし、JSON Schemaを介してTypeScript（Zod）へ型情報を変換。ZodとReactを用いて、クライアント側のフォーム構築・入力バリデーションを自動担保し、テーブルの生成ではCloudscape Design System（CDS）のフィルタ機能を活用してUI一貫性と操作性を確保。フォーム生成はCDSに限定せず、JSON FormsやReact Hook Formなど柔軟に対応。Amazon Cognitoの権限情報（ユーザーロール、グループ、属性）に基づき、フォームやテーブルのボタン表示・操作を制御。FastAPIを活用し、PydanticモデルからOpenAPI仕様を自動生成。

## 目的
- **型安全性の確保**  
  サーバーとクライアントでスキーマの一貫性を保ち、型の不整合やバリデーションの重複を排除。
- **開発・保守効率の向上**  
  単一のJSON Schemaからフォームおよびテーブルの構造、型定義、バリデーション、UIを自動生成。スキーマ修正やCognito設定更新で変更を反映。
- **UI一貫性と拡張性の両立**  
  フォーム生成はJSON FormsやReact Hook Formなどに対応し柔軟性を確保。テーブル生成はCDSのフィルタ機能を活用し、操作性と一貫性を向上。
- **権限ベースのUI制御**  
  Cognitoの権限情報に基づき、フォームやテーブルのボタンの表示/非表示や活性/非活性を制御し、セキュリティとユーザー体験を向上。
- **フォームとテーブルの自動化**  
  JSON Schemaを基にフォームとテーブルの構造を生成。OpenAPI仕様の自動生成によりAPIドキュメントを効率化。

## 利用技術・構成
- **バックエンド**: Python, Pydantic, FastAPI, AWS SDK (Boto3)  
- **共通形式**: JSON Schema（Pydanticから生成）  
- **フロントエンド**: TypeScript, Zod, React, AWS Amplify (Cognito認証)。フォーム生成はJSON FormsやReact Hook Formなど選択可能、テーブル生成はCDS。  
- **変換**: JSON SchemaからZodスキーマを生成  
- **権限管理**: Cognitoユーザープール（グループ、カスタム属性）、JWTトークン  
- **OpenAPI生成**: FastAPIのPydanticモデルを利用し、自動的にOpenAPI仕様を生成

## 運用イメージ
1. **バックエンド**:
   - Pydanticモデルでフォームおよびテーブルのデータスキーマを定義し、JSON Schemaとして公開。
   - Cognitoユーザープールでグループやカスタム属性を定義し、権限情報を管理。
   - フォームやテーブルの表示条件（例: ボタンやフィルタの権限）をメタデータとして提供。
   - FastAPIエンドポイントでPydanticモデルを返し、OpenAPI仕様を自動生成。

2. **フロントエンド**:
   - AWS AmplifyでCognito認証を行い、JWTトークンから権限情報を取得。
   - JSON SchemaからZodスキーマを生成。フォームはJSON FormsやReact Hook Formで生成、テーブルはCDSのフィルタ機能を活用して構築。
   - 権限情報に基づき、フォームやテーブルのボタン、フィルタの表示や操作を制御。
   - 入力データやフィルタ条件をZodで検証後、API経由でサーバーに送信。

3. **サーバー検証**:
   - Pydanticでデータ検証、Cognitoトークンで権限検証を実施。
   - フォーム送信やテーブル操作（例: フィルタ適用）に必要な権限をチェック。

## 効果
- **型安全と権限制御の統合**: PydanticとZodで型安全性を確保し、Cognitoで権限を管理。
- **フォームとテーブルの一元化**: JSON Schemaからフォームとテーブルの構造、バリデーション、UIを自動生成。フォームはライブラリ選択が柔軟、テーブルはCDSのフィルタで操作性向上。
- **OpenAPIの自動生成**: Pydanticモデルを返すエンドポイントにより、OpenAPI仕様を自動生成し、APIドキュメントやクライアントコード生成を効率化。
- **柔軟なUI制御**: ユーザーロールに応じたフォームやテーブルのUI制御でユーザー体験を最適化。
- **保守性向上**: 権限はCognito、データ構造はJSON Schemaで一元管理。
- **セキュリティ向上**: クライアントとサーバー双方で権限検証を実施。
